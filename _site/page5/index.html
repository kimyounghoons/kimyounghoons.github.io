<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>기록하고 기억하자! &#8211; 영훈 블로그</title>
<meta name="description" content="Describe this nonsense.">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">



<!-- Open Graph -->
<meta property="og:locale" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="기록하고 기억하자!">
<meta property="og:description" content="Describe this nonsense.">
<meta property="og:url" content="http://localhost:4000/page5/">
<meta property="og:site_name" content="영훈 블로그">
<meta property="og:image" content="http://localhost:4000/images/images/logo.png">





<link rel="canonical" href="http://localhost:4000/page5/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="영훈 블로그 Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<link rel="stylesheet" href="http://localhost:4000/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="http://localhost:4000/assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script type="text/javascript" src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">




</head>

<body id="post-index">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="header-menu header-menu-top">
    <ul class="header-item-container">
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="http://localhost:4000/">
          
            <img class="logo" src="http://localhost:4000/images/logo.png" alt="영훈 블로그">
          
          <a href="http://localhost:4000/" class="title"> 영훈 블로그</a>
        </a>
      </li>
      
        
        

        
          <li class="header-item "><a href="http://localhost:4000/categories"><h3>Categories</h3></a>
            <ul class="header-submenu">
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#Git">Git</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#RxKotlin">RxKotlin</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#Single">Single</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#SourceTree">SourceTree</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#aac">aac</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#android">android</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#applicationInfo">applicationInfo</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#blog">blog</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#firebase">firebase</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#flag">flag</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#interview">interview</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#java">java</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#kotlin">kotlin</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#mac">mac</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#notification">notification</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#sample">sample</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#singleTask">singleTask</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#알고리즘">알고리즘</a></li>
              
                
                  <li class="sub-item"><a href="http://localhost:4000/categories/#자바">자바</a></li>
              
            </ul>
          </li>
        
      
        
        

        
            
                <li class="header-item "><a href="http://localhost:4000/tags"><h3>Tags</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="http://localhost:4000/"><h3>Home</h3></a></li>
            
        
      
      <li class="header-item"><a href="http://localhost:4000/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
<div class="entry-header">
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>기록하고 기억하자!</h1>
      
        <h2><span class="entry-date"><time>&nbsp;</time></span></h2>
      

      
          <p class="entry-reading-time">
            &nbsp;
          </p><!-- /.entry-reading-time -->
      
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="http://localhost:4000/"><h3>Home</h3></a></li>
      
    
      
        <li><a href="http://localhost:4000/tags"><h3>Tags</h3></a></li>
      
    
      
        <li><a href="http://localhost:4000/categories"><h3>Categories</h3></a>
          <ul>
            
              
                <li><a href="http://localhost:4000/categories/#Git">Git</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#RxKotlin">RxKotlin</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#Single">Single</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#SourceTree">SourceTree</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#aac">aac</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#android">android</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#applicationInfo">applicationInfo</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#blog">blog</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#firebase">firebase</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#flag">flag</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#interview">interview</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#java">java</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#kotlin">kotlin</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#mac">mac</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#notification">notification</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#sample">sample</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#singleTask">singleTask</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#알고리즘">알고리즘</a></li>
            
              
                <li><a href="http://localhost:4000/categories/#자바">자바</a></li>
            
          </ul>
        </li>
      
    
  </ul>
</nav>




<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2020-01-10T00:00:00+09:00"><a href="http://localhost:4000/android/android-centerLoadingProgress/">January 10, 2020</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About kimyounghoon">kimyounghoon</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/android/android-centerLoadingProgress/" rel="bookmark" title="Center Loading Progress" itemprop="url">Center Loading Progress</a></h1>
    
  </header>
  <div class="entry-content">
      <p>API 호출 할 때 다른 터치를 막기 위해 센터 프로그레스를 보여주는 경우 여러 가지 방법이 있지만 그중 progressDialog 를 사용해보자~!</p>

<p>BaseActivity 에서 progressDialog 를 가지고 있고 필요할 때 showProgress() , hideProgress() 를 통해 보여주거나 감출수 있다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abstract class BaseActivity : AppCompatActivity(){
    private var progressDialog: AppCompatDialog? = null

    fun showProgress() {
        if (this == null || isFinishing) {
            return
        }

        progressDialog?.apply {
            dismiss()
        }

        progressDialog = AppCompatDialog(this)
        progressDialog?.apply {
            setCancelable(false)
            window?.setBackgroundDrawable(ColorDrawable(Color.TRANSPARENT))
            setContentView(R.layout.progress_center_loading)
            show()
        }
    }

    fun hideProgress() {
        progressDialog?.dismiss()
    }
}
</code></pre></div></div>

<p>아래는 layout 코드</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;androidx.constraintlayout.widget.ConstraintLayout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
    <span class="na">xmlns:app=</span><span class="s">"http://schemas.android.com/apk/res-auto"</span>
    <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
    <span class="na">android:layout_height=</span><span class="s">"match_parent"</span>
    <span class="na">android:clickable=</span><span class="s">"true"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;ProgressBar</span>
        <span class="na">style=</span><span class="s">"?android:attr/indeterminateDrawable"</span>
        <span class="na">android:layout_width=</span><span class="s">"34dp"</span>
        <span class="na">android:layout_height=</span><span class="s">"34dp"</span>
        <span class="na">android:indeterminate=</span><span class="s">"true"</span>
        <span class="na">app:layout_constraintBottom_toBottomOf=</span><span class="s">"parent"</span>
        <span class="na">app:layout_constraintEnd_toEndOf=</span><span class="s">"parent"</span>
        <span class="na">app:layout_constraintStart_toStartOf=</span><span class="s">"parent"</span>
        <span class="na">app:layout_constraintTop_toTopOf=</span><span class="s">"parent"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span>
</code></pre></div></div>

<p>이 경우 장점은 
BaseActivity 를 상속 받는 Activity 의 경우 showProgress , hideProgress 를 통해 간편하게 사용할 수 있다.</p>

<p>그리고 액티비티 layout에서 위의 layout 코드를 포함 하고 있지 않아도 된다.</p>

<p>단점은 필요 하지 않은 Activity 에서도 progressDialog 변수를 가지고 있을 수 있다.</p>

<p>다른 방법으로는 Application class 에서 가지고 있거나 싱글톤 클래스로 가지고 있어도 괜찮을것 같다.</p>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2019-12-26T00:00:00+09:00"><a href="http://localhost:4000/android/android-bindingadapter/">December 26, 2019</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About kimyounghoon">kimyounghoon</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/android/android-bindingadapter/" rel="bookmark" title="DataBidning , BindingAdapter" itemprop="url">DataBidning , BindingAdapter</a></h1>
    
  </header>
  <div class="entry-content">
      <p>데이터 바인딩라이브러리는 레이아웃의 UI 구성 요소를 프로그래밍 방식이 아닌 선언적 형식을 사용하여 앱의 데이터 소스에 바인딩 할 수있는 지원 라이브러리다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;layout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
    <span class="na">xmlns:app=</span><span class="s">"http://schemas.android.com/apk/res-auto"</span>
    <span class="na">xmlns:bind=</span><span class="s">"http://schemas.android.com/tools"</span>
    <span class="na">xmlns:tools=</span><span class="s">"http://schemas.android.com/tools"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;data&gt;</span>
        <span class="nt">&lt;import</span> <span class="na">type=</span><span class="s">"android.view.View"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;variable</span>
            <span class="na">name=</span><span class="s">"viewModel"</span>
            <span class="na">type=</span><span class="s">"패키지경로.ExampleViewModel"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
    <span class="nt">&lt;androidx.constraintlayout.widget.ConstraintLayout</span>
            <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
            <span class="na">android:layout_height=</span><span class="s">"match_parent"</span>
            <span class="na">android:background=</span><span class="s">"@{viewModel.isRedBackground ? @color/red : @color/white}"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span>
<span class="nt">&lt;/layout&gt;</span>

</code></pre></div></div>

<p>예를 들어 API 호출을 하고 받아온 값이 빨간색 배경색을 가져야 한다면 viewModel.isRedBackground (ObservableField Boolean 값) 데이터 변경 만으로 뷰가 빨간색 또는 흰색으로 변경 된다. 하지만 상태값이 빨간색 흰색 그외 초록색이 필요하다면 BindingAdapter를 통해서 구현할 수 있다.</p>

<p>android:background=”@{viewModel.isRedBackground ? @color/red : @color/white}”<br />
–&gt; bind:status=”@{viewModel.status}”</p>

<p>위의 코드에서 해당 줄만 변경한다. 그 다음 BindingAdapter를 만들어준다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@BindingAdapter("bind:status")
fun bindBuyingStatusText(imageView: ImageView, status: String?) {
    when (status) {
        "빨간색" -&gt; {
            imageView.setBackgroundColor(imageView.context.getColor(R.color.color_red))
        }
        "흰색" -&gt; {
            imageView.setBackgroundColor(imageView.context.getColor(R.color.color_white))
        }
        else -&gt; {  //초록색
            imageView.setBackgroundColor(imageView.context.getColor(R.color.color_green))
        }
    }
}

</code></pre></div></div>

<p>상태값이 2가지만 있는경우에도 BindingAdapter 사용해서 처리할수 있지만 굳이 사용할 필요는 없을것 같다.</p>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2019-12-12T00:00:00+09:00"><a href="http://localhost:4000/android/android-rxkotlin_combineLatest/">December 12, 2019</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About kimyounghoon">kimyounghoon</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/android/android-rxkotlin_combineLatest/" rel="bookmark" title="RxKotlin combineLatest" itemprop="url">RxKotlin combineLatest</a></h1>
    
  </header>
  <div class="entry-content">
      <p>집에 와서 안드로이드 단톡방 쭉쭉 보다가 어떤 분이 질문 올린 글을 봤다.<br />
Rx 공부 해야지 해야지 생각 하다가 안하고 있었는데 마침 문제가 하나 생김 ㅎㅎ</p>

<p>문제는 RxKotlin 을 사용해서 입력창 세가지가 있는데 각각 입력창에서 입력 할 때마다 validation 체크를 하고 다 통과 되면 버튼을 활성화 시키고 싶다.</p>

<p>키워드는 combineLatest 이다. 아래의 TestCode 를 보자.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class CombineLatestTest {
    @Test
    fun test() {
        var isValid = false
        val emailSubject = BehaviorSubject.create&lt;String&gt;()
        val passwordSubject = BehaviorSubject.create&lt;String&gt;()
        val nickNameSubject = BehaviorSubject.create&lt;String&gt;()
        BehaviorSubject.combineLatest&lt;String, String, String, Boolean&gt;(
            emailSubject,
            passwordSubject,
            nickNameSubject,
            Function3&lt;String, String, String, Boolean&gt; { email, password, nickname -&gt;
                return@Function3 email.isNotEmpty() &amp;&amp; password.isNotEmpty() &amp;&amp; nickname.isNotEmpty()
            }
        ).subscribe { result -&gt;
            isValid = result
             println("활성화 여부 $isValid")
        }

        emailSubject.onNext("이메일 입력")
        assertEquals(isValid, false)

        passwordSubject.onNext("패스워드 입력")
        assertEquals(isValid, false)

        nickNameSubject.onNext("닉네임 입력")
        assertEquals(isValid, true)

        passwordSubject.onNext("")  //패스워드 제거
        assertEquals(isValid, false)

        passwordSubject.onNext("패스워드 입력")  //패스워드 다시 입력
        assertEquals(isValid, true)

    }

}


    결과는 
    활성화 여부 false
    활성화 여부 false
    활성화 여부 true
    활성화 여부 false
    활성화 여부 true


</code></pre></div></div>

<p>combineLatest 은 파라미터로 ObservableSource 를 받고 마지막에 리턴할 Function 을 받는다.<br />
ObservableSource 갯수 제한은 9개 까지로 확인했다.<br />
테스트 코드라서 isNotEmpty 로 처리 해뒀는데 저기 부분이 isValid 로 변경 되면 되겠다~</p>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2019-12-09T00:00:00+09:00"><a href="http://localhost:4000/android/android-debug-signingkey/">December 09, 2019</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About kimyounghoon">kimyounghoon</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/android/android-debug-signingkey/" rel="bookmark" title="디버그 용 서명 키 만들기" itemprop="url">디버그 용 서명 키 만들기</a></h1>
    
  </header>
  <div class="entry-content">
      <p>기본적으로 Android Studio 에서 프로젝트를 만들게 되면 기본적으로 Build Variants가 Debug 로 셋팅 되어 있다.</p>

<p>Android SDK 도구에서 생성된 디버그 인증서를 사용하여 앱에 자동으로 서명하기 때문이다.</p>

<p>안드로이드 앱을 출시 하기 위해서는 Release KeyStore 를 통해 서명 된 앱이 필요하다.</p>

<p>Release KeyStore 를 생성해서 서명한 앱을 출시 하고 난 뒤, Release 용 apk 가 설치 된 앱에서 Debug 모드로 빌드하게 되면 빌드 실패가 뜨고 삭제 후 설치 하시겠습니까? 라는 팝업이 뜬다.</p>

<p>이 이유는 Release apk 와 Debug apk 인증 정보가 다르기 때문이다.</p>

<p>이렇게 되면 삭제 후 설치는 할 수 있지만 Build Variants 가 변경될 때마다 다시 설치해야하는 번거러움도 있고 삭제하지 않고 디버깅 하고 싶은 상황에서 할 수 없게 된다.</p>

<p>이 상황을 해결 하기 위해서는 Release Keystore 로부터 Debug Keystore 를 만들면 된다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>keytool -importkeystore -v -srckeystore 릴리즈용 키스토어 파일이름 및 경로 -destkeystore 디버그용 키스토어 파일이름 및 경로 -srcstorepass 릴리즈용 키스토어 비밀번호 -deststorepass android -srcalias alias이름 -destalias androiddebugkey -srckeypass alias비밀번호 -destkeypass android
</code></pre></div></div>

<p>새로 만드는 Debug Keystore 를 Android Studio 기본 제공해주는 Debug Keystore 와 매칭 시켜주는 작업이다.<br />
-destalias androiddebugkey , -deskkeypass android  는 Android SDK 도구에서 생성된 디버그 인증 정보와 동일하게 해서 나중에 별도 셋팅이 필요없다.</p>

<p>build.gradle 셋팅은 아래와 같이 하면 된다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>android {
 signingConfigs {
        release {
            storeFile file('릴리즈 키스토어 경로')
            storePassword '패스워드'
            keyAlias '릴리즈 alias'
            keyPassword '패스워드'
        }

        debug {
            storeFile file('디버그 키스토어 경로')
            //따로 정보 필요 없음
        }
    }
}
</code></pre></div></div>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2019-11-27T00:00:00+09:00"><a href="http://localhost:4000/android/android-diffUtil/">November 27, 2019</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About kimyounghoon">kimyounghoon</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/android/android-diffUtil/" rel="bookmark" title="RecyclerView DiffUtil" itemprop="url">RecyclerView DiffUtil</a></h1>
    
  </header>
  <div class="entry-content">
      <p>oldList 와 newList 리스트의 차이를 계산하고 oldList를 newList로 변환하는 업데이트 작업 목록을 출력 할 수있는 유틸리티 클래스이다.<br />
업데이트 작업 목록은 newList 가 Insert , Remove , Update 다 포함 된다.</p>

<h3 id="리스트-아이템이-변경-되는-갯수-마다의-시간-데이터">리스트 아이템이 변경 되는 갯수 마다의 시간 데이터</h3>

<ul>
  <li>100 items and 10 modifications: avg: 0.39 ms, median: 0.35 ms</li>
  <li>100 items and 100 modifications: 3.82 ms, median: 3.75 ms</li>
  <li>100 items and 100 modifications without moves: 2.09 ms, median: 2.06 ms</li>
  <li>1000 items and 50 modifications: avg: 4.67 ms, median: 4.59 ms</li>
  <li>1000 items and 50 modifications without moves: avg: 3.59 ms, median: 3.50 ms</li>
  <li>1000 items and 200 modifications: 27.07 ms, median: 26.92 ms</li>
  <li>1000 items and 200 modifications without moves: 13.54 ms, median: 13.36 ms</li>
</ul>

<p>Eugene W. Myers 의 difference algorithm 을 사용하여 하나의 목록을 다른 목록으로 변환하기위한 최소 업데이트 수를 계산한다.</p>

<p>사용법을 알아보자~!</p>

<p>우선 아래와 같이 DiffUtil.Callback 을 상속받는 DiffCallback 클래스를 만들고 비교할 대상을 지정 해준다.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class DiffCallback(
		private val oldData: AdapterData,
		private val newData: AdapterData
	) : DiffUtil.Callback() {

	override fun getOldListSize() = oldData.size

	override fun getNewListSize() = newData.size

	override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int)
     = oldData[oldItemPosition].id == newData[newItemPosition].id

	override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int)
     = oldData[oldItemPosition] == newData[newItemPosition]

}
</code></pre></div></div>

<p>다음으로는 RecyclerView Adapter 클래스의 setData 를 보자</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fun setData(newData: AdapterData) {
	val diffResult = DiffUtil.calculateDiff(DiffCallback(data, newData))
	data = newData
	diffResult.dispatchUpdatesTo(this)
}
</code></pre></div></div>

<p>DiffUtil.calculateDiff 는 DiffCallback 을 인자로 받고 결과 값으로 DiffUtil.DiffResult 를 반환 한다.<br />
그 다음 RecyclerView Adapter 의 아이템을 대체 시켜 주고 dispatchUpdatesTo 를 호출한다.  여기서 this는 RecyclerView Adapter 이다.<br />
RecyclerView Adapter 를 파라미터로 받는 이유는 내부적으로 dispatchUpdatesTo 를 호출 하는 순간 뷰가 갱신 된다.<br />
그렇기 때문에 다음 4가지 중 한가지를 호출 하기 위해서라고 판단 된다.</p>
<ul>
  <li>mAdapter.notifyItemRangeInserted(position, count);</li>
  <li>mAdapter.notifyItemRangeRemoved(position, count);</li>
  <li>mAdapter.notifyItemMoved(fromPosition, toPosition);</li>
  <li>mAdapter.notifyItemRangeChanged(position, count, payload);</li>
</ul>

<p>기존 방식은 OldList 에서 변경 된 포지션을 직접 위의 4가지중 한가지를 불러서 뷰를 갱신 시켜줬어야 하는데 DiffUtil 을 사용하면 개발자가 신경 쓰지 않아도 편리하게 수정 할수 있어서 좋은 것 같다.</p>

<h3 id="주의-사항">주의 사항</h3>
<ol>
  <li>리스트 사이즈가 큰 경우는 DiffResult를 가져올때 Background Thread 에서 실행 하고 뷰 갱신 할때만 메인스레드에서 실행 시켜야한다.</li>
  <li>DiffUtil 사용 할 때 리스트의 Max Size 는 2^26 이다.</li>
</ol>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="http://localhost:4000/page4/" class="btn">Previous</a></li>
      
    

    
    
      <li><a href="http://localhost:4000/">1</a></li>
    

    
    
      
      
      <li>…</li>
    

    
    
    

    
      
        
        
        
        <li><a href="http://localhost:4000/page3/">3</a></li>
      
    
      
        
        
        
        <li><a href="http://localhost:4000/page4/">4</a></li>
      
    
      
        <li><strong class="current-page">5</strong></li>
      
    
      
        
        
        
        <li><a href="http://localhost:4000/page6/">6</a></li>
      
    
      
        
        
        
        <li><a href="http://localhost:4000/page7/">7</a></li>
      
    

    
    
      <li>…</li>
    

    
      <li><a href="http://localhost:4000/page14/">14</a></li>
    

    
    
      <li><a href="http://localhost:4000/page6/" class="btn">Next</a></li>
    
  </ul>
</div>


</div><!-- /#main -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="http://localhost:4000/assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>



<!-- Asynchronous Google Analytics snippet -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-154716591-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>





<script type="text/javascript">
    sharing();
</script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-154716591-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-154716591-1');
</script>


<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2020 kimyounghoon. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
